@startuml
skinparam packageStyle rectangle
skinparam shadowing false

package "UI" {
  class DesktopApp
  class AssetPaletteWidget
  class DevicePanel
  class LicensePanel
  class ConfigCanvasWidget
  class ConfigGraphicsView
  class ConfigCardWidget
  class ConfigCardProxy
  class MiniMapView
  class UIActions
  class BasicActions
  class UndoStack
  class ToastManager
}

package "Services" {
  class AssetService
  class ConfigService
}

package "UI State" {
  class UIStateStore
  class CanvasState
}

package "Repositories" {
  class DeviceRepository
  class LicenseRepository
  class ConfigRepository
}

package "Infra" {
  class AppDB as "init_db"
  class SQLite
}

DesktopApp --> AssetPaletteWidget
DesktopApp --> DevicePanel
DesktopApp --> LicensePanel
DesktopApp --> ConfigCanvasWidget
DesktopApp --> UIActions
DesktopApp --> UndoStack
DesktopApp --> ToastManager

AssetPaletteWidget --> AssetService
DevicePanel --> AssetService
LicensePanel --> AssetService

ConfigCanvasWidget --> ConfigGraphicsView
ConfigCanvasWidget --> ConfigCardWidget
ConfigCanvasWidget --> ConfigCardProxy
ConfigCanvasWidget --> MiniMapView
ConfigCanvasWidget --> UIStateStore
ConfigCanvasWidget --> ConfigService
ConfigCardWidget --> UIActions
ConfigCardWidget --> ConfigService
BasicActions ..|> UIActions

AssetService --> DeviceRepository
AssetService --> LicenseRepository
ConfigService --> ConfigRepository

AppDB --> SQLite
DeviceRepository --> SQLite
LicenseRepository --> SQLite
ConfigRepository --> SQLite
UIStateStore --> SQLite
@enduml
